# ? FIX ADVANCED REPORTS FORM - COMPLETE GUIDE

## ?? V?N ??
1. **Bi?u ?? không hi?n th?** - AdvancedReportsForm
2. **Ch? ti?ng Vi?t b? l?i encoding** - "T?ng quan", "Hoàn thành" ? "T?ng quan", "Ho

àn th?nh"

## ? GI?I PHÁP

### **Ph?n 1: Ch?y Script PowerShell**

1. **Double-click:**
   ```
   fix_advanced_reports.ps1
   ```

2. **Ho?c ch?y trong PowerShell:**
   ```powershell
   .\fix_advanced_reports.ps1
   ```

### **Ph?n 2: S?a Th? Công (N?u Script L?i)**

#### **File: `ToDoList.GUI\Forms\AdvancedReportsForm.cs`**

#### **1. S?a Form Title:**

**TÌM:**
```csharp
this.Text = "Th?ng kê nâng cao - ToDoList Analytics";
```

**THAY B?NG:**
```csharp
this.Text = "Thong ke nang cao - ToDoList Analytics";
```

#### **2. S?a Tab Names:**

**TÌM:**
```csharp
var tabOverview = new TabPage("T?ng quan");
var tabCharts = new TabPage("Bi?u ??");
var tabStats = new TabPage("Th?ng kê");
```

**THAY B?NG:**
```csharp
var tabOverview = new TabPage("Tong quan");
var tabCharts = new TabPage("Bieu do");
var tabStats = new TabPage("Thong ke");
```

#### **3. S?a Stats Card Labels (Method: `CreateStatCard`):**

**TÌM:**
```csharp
CreateStatCard("T?ng Projects", totalProjects.ToString(), "projects", ...);
CreateStatCard("T?ng Tasks", totalTasks.ToString(), "tasks", ...);
CreateStatCard("Hoàn thành", completionRate.ToString("F0") + "%", "completion", ...);
CreateStatCard("Th?i gian", $"{totalTimeSpent:F1}h", "time spent", ...);
```

**THAY B?NG:**
```csharp
CreateStatCard("Tong Projects", totalProjects.ToString(), "projects", ...);
CreateStatCard("Tong Tasks", totalTasks.ToString(), "tasks", ...);
CreateStatCard("Hoan thanh", completionRate.ToString("F0") + "%", "completion", ...);
CreateStatCard("Thoi gian", $"{totalTimeSpent:F1}h", "time spent", ...);
```

#### **4. S?a Method `CreateStatCard` - Font:**

**TÌM:**
```csharp
Font = new Font("Segoe UI", 18F, FontStyle.Bold)
```

**THAY B?NG:**
```csharp
Font = new Font("Arial", 18F, FontStyle.Bold, GraphicsUnit.Point)
```

**TÌM:**
```csharp
Font = new Font("Segoe UI", 10F)
```

**THAY B?NG:**
```csharp
Font = new Font("Arial", 10F, FontStyle.Regular, GraphicsUnit.Point)
```

#### **5. Fix Chart Initialization:**

**TÌM:**
```csharp
var chart = new InteractiveChartControl();
```

**THAY B?NG:**
```csharp
var chart = new InteractiveChartControl
{
    Dock = DockStyle.Fill,
    BackColor = Color.FromArgb(25, 25, 25),
    Font = new Font("Arial", 9F, FontStyle.Regular, GraphicsUnit.Point)
};
```

#### **6. T?t c? Text Ti?ng Vi?t Khác:**

| Tìm | Thay |
|-----|------|
| Không có d? li?u | Khong co du lieu |
| Bi?u ?? | Bieu do |
| Công vi?c | Cong viec |
| D? án | Du an |
| Th?ng kê | Thong ke |
| Báo cáo | Bao cao |
| T?ng s? | Tong so |
| Hoàn thành | Hoan thanh |
| ?ang làm | Dang lam |
| Ch?a làm | Chua lam |

### **Ph?n 3: Ki?m Tra InteractiveChartControl**

#### **File: `ToDoList.GUI\Components\InteractiveChartControl.cs`**

? **File này ?Ã ???C FIX ??y ??, bao g?m:**
- ? X? lý `maxValue = 0`
- ? X? lý `barWidth <= 0`
- ? X? lý `height < 1f`
- ? X? lý `radius < 10`
- ? Font Arial cho tooltip
- ? T?t c? edge cases

**KHÔNG C?N S?A GÌ THÊM!**

## ?? **CÁCH TEST SAU KHI S?A:**

### **1. Build l?i:**
```
Ctrl + Shift + B
```

### **2. Ch?y ?ng d?ng:**
```
F5
```

### **3. M? Advanced Reports Form:**
- Click vào **"?? Th?ng kê nâng cao"** t? menu project
- Ho?c ch?y t? menu **"?? Báo cáo"**

### **4. Ki?m tra:**

? **Title bar ph?i hi?n th?:**
```
Thong ke nang cao - ToDoList Analytics
```

? **Tab names ph?i hi?n th?:**
```
Tong quan | Bieu do | Thong ke
```

? **Stats cards ph?i hi?n th?:**
```
???????????????????????
?  Tong Projects      ?
?      6              ?
?  projects           ?
???????????????????????

???????????????????????
?  Tong Tasks         ?
?      21             ?
?  tasks              ?
???????????????????????

???????????????????????
?  Hoan thanh         ?
?      29%            ?
?  completion         ?
???????????????????????

???????????????????????
?  Thoi gian          ?
?      103.0h         ?
?  time spent         ?
???????????????????????
```

? **Bi?u ?? ph?i hi?n th?:**
- Bi?u ?? c?t (Bar Chart)
- Bi?u ?? ???ng (Line Chart)
- Bi?u ?? tròn (Pie Chart)
- Có th? zoom b?ng chu?t
- Có th? kéo ?? di chuy?n
- Hover ?? xem tooltip

## ?? **N?U V?N L?I:**

### **V?n ?? 1: Bi?u ?? v?n không hi?n th?**

**Nguyên nhân:** Data không ???c load ?úng

**Gi?i pháp:**
1. Check method `LoadChartData()` trong AdvancedReportsForm
2. ??m b?o `_context` ?ã ???c kh?i t?o
3. Ki?m tra có d? li?u trong database không (ch?y **Test Data** button)

**Debug code:**
```csharp
// Trong AdvancedReportsForm constructor:
MessageBox.Show($"Total Projects: {totalProjects}, Total Tasks: {totalTasks}");

// Tr??c khi set chart data:
MessageBox.Show($"Chart data count: {chartData.Count}");
```

### **V?n ?? 2: Ch? v?n b? l?i encoding**

**Nguyên nhân:** Font không h? tr? ho?c encoding file sai

**Gi?i pháp:**
1. ??m b?o file ???c save v?i encoding **UTF-8**
2. ??i T?T C? font t? "Segoe UI" ? "Arial"
3. Ki?m tra l?i t?ng dòng text có d?u

**PowerShell ?? check encoding:**
```powershell
$content = Get-Content "ToDoList.GUI\Forms\AdvancedReportsForm.cs" -Raw
$content -match "T?ng|Hoàn|Th?i"  # Ph?i return True n?u còn d?u
```

### **V?n ?? 3: Crash khi m? form**

**Nguyên nhân:** Exception trong chart rendering

**Gi?i pháp:**
1. Wrap t?t c? chart code trong try-catch:
```csharp
try
{
    chart.SetData(chartData, ChartType.Bar);
}
catch (Exception ex)
{
    MessageBox.Show($"Chart error: {ex.Message}");
}
```

2. Check stack trace ?? tìm dòng gây l?i

## ?? **CHECKLIST HOÀN CH?NH:**

### **Code:**
- [ ] AdvancedReportsForm.cs title ??i sang không d?u
- [ ] Tab names ??i sang không d?u  
- [ ] Stats card labels ??i sang không d?u
- [ ] Font ??i t? Segoe UI ? Arial
- [ ] Chart initialization có Dock và BackColor
- [ ] T?t c? text ti?ng Vi?t ??i sang không d?u

### **Ch?c n?ng:**
- [ ] Form m? không crash
- [ ] Title hi?n th? ?úng
- [ ] Stats cards hi?n th? s? li?u
- [ ] Bi?u ?? hi?n th? (không ph?i tr?ng)
- [ ] Zoom chart ho?t ??ng (l?n chu?t)
- [ ] Pan chart ho?t ??ng (kéo chu?t)
- [ ] Hover tooltip ho?t ??ng

### **Hi?n th?:**
- [ ] Không có d?u ? trong text
- [ ] Font ch? rõ ràng, d? ??c
- [ ] Màu s?c chu?n (không b? m?)
- [ ] Layout không b? l?i
- [ ] Responsive khi resize window

## ?? **K?T QU? MONG ??I:**

Sau khi fix xong, form ph?i trông nh? này:

```
????????????????????????????????????????????????????????????
?  Thong ke nang cao - ToDoList Analytics               X  ?
????????????????????????????????????????????????????????????
?  Tong quan | Bieu do | Thong ke                          ?
????????????????????????????????????????????????????????????
?                                                           ?
?  ?????????????  ?????????????  ?????????????  ??????????
?  ?Tong Proj. ?  ?Tong Tasks ?  ?Hoan thanh ?  ?Thoi gian?
?  ?     6     ?  ?     21    ?  ?    29%    ?  ? 103.0h ?
?  ? projects  ?  ?   tasks   ?  ?completion ?  ?time spent?
?  ?????????????  ?????????????  ?????????????  ??????????
?                                                           ?
?  [Bi?u ?? c?t v?i data hi?n th? ??y ??]                  ?
?  ?? ??????????                                            ?
?     ????????                                              ?
?     ????                                                  ?
?  ????????????????????                                     ?
?                                                           ?
????????????????????????????????????????????????????????????
```

**? T?t c? text không d?u, bi?u ?? hi?n th?, font Arial rõ ràng!**

## ?? **L?U Ý QUAN TR?NG:**

1. **Luôn backup tr??c khi s?a:**
   ```
   ToDoList.GUI\Forms\AdvancedReportsForm.cs.backup
   ```

2. **Rebuild toàn b? sau khi s?a:**
   ```
   Build > Clean Solution
   Build > Rebuild Solution
   ```

3. **Test v?i d? li?u th?t:**
   - Ch?y **Test Data** button tr??c
   - ??m b?o có ít nh?t 5-10 projects và tasks

4. **N?u c?n revert:**
   ```powershell
   Copy-Item "ToDoList.GUI\Forms\AdvancedReportsForm.cs.backup" `
            -Destination "ToDoList.GUI\Forms\AdvancedReportsForm.cs" `
            -Force
   ```

**Chúc may m?n!** ??
