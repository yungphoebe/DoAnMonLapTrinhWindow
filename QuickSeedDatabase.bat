@echo off
chcp 65001 > nul
color 0A
echo.
echo ??????????????????????????????????????????????????????????
echo ?     ToDoList App - SEED D? LI?U M?U NHANH            ?
echo ??????????????????????????????????????????????????????????
echo.
echo ?? Script này s?:
echo    1. Xóa t?t c? d? li?u c?
echo    2. Seed d? li?u m?u m?i
echo.
echo ??  C?NH BÁO: T?t c? d? li?u hi?n t?i s? b? xóa!
echo.
set /p confirm="B?n có mu?n ti?p t?c? (Y/N): "

if /i "%confirm%" neq "Y" (
    echo.
    echo ? ?ã h?y!
    pause
    exit /b
)

cd /d "%~dp0"

echo.
echo ? Chu?n b? môi tr??ng...

REM Copy appsettings.json n?u ch?a có
if not exist "appsettings.json" (
    if exist "TodoListApp.DAL\appsettings.json" (
        copy "TodoListApp.DAL\appsettings.json" "appsettings.json" > nul
        echo ? ?ã copy appsettings.json
    )
)

echo ? ?ang build project...
dotnet build TodoListApp.DAL\TodoListApp.DAL.csproj --configuration Release -v quiet
if %errorlevel% neq 0 (
    echo.
    echo ? Build failed! Vui lòng ki?m tra l?i.
    pause
    exit /b %errorlevel%
)

echo ? Build thành công!
echo.
echo ?? ?ang seed d? li?u...
echo.

REM T? ??ng ch?n option 3 và gõ 'yes'
echo 3> temp_input.txt
echo yes>> temp_input.txt

dotnet run --project TodoListApp.DAL\TodoListApp.DAL.csproj --configuration Release < temp_input.txt

del temp_input.txt > nul 2>&1

echo.
echo ???????????????????????????????????????????????????????
echo.
echo ? HOÀN T?T! 
echo.
echo ?? D? li?u m?u ?ã ???c seed thành công!
echo ?? B?n có th? ch?y ?ng d?ng ToDoList.GUI ?? test
echo.
echo ???????????????????????????????????????????????????????
echo.
pause
